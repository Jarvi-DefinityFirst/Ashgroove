import{a as H}from"./chunk-AXFFVIEE.js";import{a as J,b as k}from"./chunk-4UT6PFYX.js";import{a as A}from"./chunk-2HMVLMMD.js";import{b as W,c as R,d as q,g as D,j as O,k as L,s as B,u as j}from"./chunk-6YNLSSCZ.js";import{T as V,U as F,X as T,i as N}from"./chunk-X6SMWKVA.js";import{k as x,q as I}from"./chunk-KQATVZ4O.js";import"./chunk-4PPJG5BB.js";import{$b as v,Fb as p,Gb as n,Hb as i,Ib as M,Mb as P,Pb as y,Rb as C,Ua as c,Za as _,db as w,ec as l,ha as u,ia as f,jb as g,jc as h,kc as E,lc as b}from"./chunk-4SEB7VVV.js";import{a as S}from"./chunk-DRSDQDGF.js";function G(a,o){a&1&&(n(0,"div",12),l(1," Name is required "),i())}function Q(a,o){a&1&&(n(0,"div",12),l(1," Caregory is required "),i())}function U(a,o){if(a&1&&(n(0,"div",4),M(1,"pdf-viewer",13),i()),a&2){let t=C(2);c(),p("src",t.pdfSrc)("render-text",!0)("show-all",!0)}}function K(a,o){if(a&1&&(n(0,"div",4),g(1,U,2,3,"div",10),i()),a&2){let t=C();c(),p("ngIf",t.pdfSrc)}}var s=class s{constructor(o,t){this.router=o;this.procedureService=t;this.procedimiento=null;this.pdfSrc=null}ngOnInit(){this.procedureService.getProcedimiento().subscribe(o=>{this.procedimiento=S({},o),this.procedimiento.content?.startsWith("data:application/pdf")?this.pdfSrc=this.procedimiento.content:this.pdfSrc=null})}guardar(o){if(o.invalid||!this.pdfSrc)return;this.procedimiento.content=this.pdfSrc;let t=localStorage.getItem("demo_procedimientos"),e=t?JSON.parse(t):[],d=e.findIndex(m=>m.id===this.procedimiento.id);d!==-1&&(e[d]=S({},this.procedimiento),localStorage.setItem("demo_procedimientos",JSON.stringify(e))),console.log("Procedimiento actualizado:",this.procedimiento),this.router.navigate(["/procedure"])}onFileSelected(o){let t=o.target.files?.[0];if(t){let e=new FileReader;e.onload=()=>{let d=e.result;this.pdfSrc=d,this.procedimiento.content=d},e.readAsDataURL(t)}}};s.\u0275fac=function(t){return new(t||s)(_(N),_(A))},s.\u0275cmp=w({type:s,selectors:[["app-procedure-edit"]],decls:26,vars:6,consts:[["procedureForm","ngForm"],["name","ngModel"],["category","ngModel"],[3,"ngSubmit"],[1,"mb-3"],[1,"form-label"],["type","text","name","name","required","",1,"form-control",3,"ngModelChange","ngModel"],["class","text-danger small",4,"ngIf"],["type","text","name","category","required","",1,"form-control",3,"ngModelChange","ngModel"],["type","file","accept","application/pdf",1,"form-control",3,"change"],["class","mb-3",4,"ngIf"],["type","submit",1,"btn","btn-primary",3,"disabled"],[1,"text-danger","small"],[2,"height","500px","display","block",3,"src","render-text","show-all"]],template:function(t,e){if(t&1){let d=P();n(0,"c-card")(1,"c-card-header")(2,"strong"),l(3,"Edit Procedure"),i()(),n(4,"c-card-body")(5,"form",3,0),y("ngSubmit",function(){u(d);let r=v(6);return f(e.guardar(r))}),n(7,"div",4)(8,"label",5),l(9,"Name"),i(),n(10,"input",6,1),b("ngModelChange",function(r){return u(d),E(e.procedimiento.name,r)||(e.procedimiento.name=r),f(r)}),i(),g(12,G,2,0,"div",7),i(),n(13,"div",4)(14,"label",5),l(15,"Category"),i(),n(16,"input",8,2),b("ngModelChange",function(r){return u(d),E(e.procedimiento.category,r)||(e.procedimiento.category=r),f(r)}),i(),g(18,Q,2,0,"div",7),i(),n(19,"div",4)(20,"label",5),l(21,"Content"),i(),n(22,"input",9),y("change",function(r){return u(d),f(e.onFileSelected(r))}),i()(),g(23,K,2,1,"div",10),n(24,"button",11),l(25," Save "),i()()()()}if(t&2){let d=v(6),m=v(11),r=v(17);c(10),h("ngModel",e.procedimiento.name),c(2),p("ngIf",m.invalid&&m.touched),c(4),h("ngModel",e.procedimiento.category),c(2),p("ngIf",r.invalid&&r.touched),c(5),p("ngIf",e.pdfSrc),c(),p("disabled",d.invalid)}},dependencies:[I,x,j,L,W,R,q,B,O,D,V,T,F,H,k,J],encapsulation:2});var z=s;export{z as ProcedureEditComponent};
